/**
* 
* Main Script
* 
*/
["turbo:click","turbo:submit-start"].forEach(function(t){window.addEventListener(t,function(){Turbo.navigator.delegate.adapter.showProgressBar()})});

document.addEventListener("turbo:load",function(){carouselIndex(),mainNav(),darkMode(),postPaginationMultiple(),adsMove(),backToTop();let o=$(".post-detail"),e=0;o.length>0&&$(window).on("load scroll",function(){var t=o.outerHeight();$(window).scrollTop()+$(window).height()>=t&&!e&&(e=1,relatedPost(),postComment())})});

/* main-nav */
function mainNav(){$("#main-nav div.nav-link").unbind("click"),$("#main-nav div.nav-link").on("click",function(){let n=$(this),a=n.data("nav");$("#main-nav div.nav-link").removeClass("active"),n.addClass("active"),$("#main-content, #main-categories, #main-archive, #main-sidebar").addClass("d-none"),$("#main-"+a).removeClass("d-none"),$("#widget-main-header, #widget-main-pinned").addClass("d-none")}),$(".back-to-content").on("click",function(){$("#main-categories, #main-archive, #main-sidebar").addClass("d-none"),$("#main-nav div.nav-link").removeClass("active"),$("#widget-main-header, #widget-main-pinned, #main-content").removeClass("d-none")})}

/* dark mode */
function darkMode(){$(".dark-mode").unbind("click"),$(".dark-mode").on("click",function(){let a=$("i",this);a.hasClass("bi-moon")?(a.removeClass("bi-moon").addClass("bi-brightness-high"),$("body").addClass("dark-mode"),$("#main-header, #main-nav").removeClass("navbar-light bg-white").addClass("navbar-dark bg-dark"),localStorage.setItem("dark","true")):(a.removeClass("bi-brightness-high").addClass("bi-moon"),$("body").removeClass("dark-mode"),$("#main-header, #main-nav").removeClass("navbar-dark bg-dark").addClass("navbar-light bg-white"),localStorage.removeItem("dark"))}),localStorage.dark&&($(".dark-mode i").removeClass("bi-moon").addClass("bi-brightness-high"),$("body").addClass("dark-mode"),$("#main-header, #main-nav").removeClass("navbar-light bg-white").addClass("navbar-dark bg-dark"))}

/* carousel index */
function carouselIndex(){$("#carouselTrending").length>0&&new bootstrap.Carousel("#carouselTrending")}

/* post index pagination */
function postPaginationMultiple(){let t=$("#postPaginationMultiple"),i=0;t.length>0&&$(window).on("load scroll",function(){if($(window).scrollTop()+$(window).height()>=$(document).height()-100&&!i){i=1;var t=$("#postPaginationMultiple a.pagination-link"),a=t.attr("href"),n=t.data("loading");void 0!==a?($("#postPaginationMultiple").html(`<div class="text-center py-3"><div class="spinner-border text-primary" role="status"> <span class="visually-hidden">${n}</span> </div></div>`),$.ajax({url:a,dataType:"html",success:function(t){setTimeout(function(){$("#postPaginationMultiple").html($(t).find("#postPaginationMultiple a.pagination-link").clone()),$("#postIndex").append($("#postIndex",$(t).wrap("<div/>")).html());let a=$(t).find(".ads-move-to-feed");$(".ads-target-feed:last").append(a),i=0},1e3)}})):$("#postPaginationMultiple").html('<div class="text-center text-success fw-bold fs-3"><i class="bi bi-check-circle"></i></div>')}})}

/* ads move */
function adsMove(){let t=parseInt($(".post-content p").length/2);$(".ads-move-to-post-middle").insertAfter(`.post-content p:nth-of-type(${t})`),$(".ads-move-to-post-bottom").appendTo(".ads-target-post-bottom"),$(".ads-move-to-feed").appendTo(".ads-target-feed")}

/* back to top button */
function backToTop(){$(window).scroll(function(){$(this).scrollTop()>100?$("#btn-back-to-top").fadeIn():$("#btn-back-to-top").fadeOut()}),$("#btn-back-to-top").click(function(){$("html, body").animate({scrollTop:0},200)})}

/* toast */
function showToast(t){$("#main-toast .toast-body").html(t);new bootstrap.Toast(document.getElementById("main-toast")).show()}

/* lazy load */
document.addEventListener("DOMContentLoaded",function(){var e;function t(){e&&clearTimeout(e);var t=document.getElementsByClassName("lazy");!(t.length<1)&&(e=setTimeout(function(){for(var e=window.pageYOffset,n=0;n<t.length;n++)t[n].offsetTop<window.innerHeight+e&&(t[n].src=t[n].dataset.src,t[n].classList.remove("lazy"))},20))}document.addEventListener("scroll",t),window.addEventListener("resize",t),window.addEventListener("orientationChange",t)});

// Table Of Contents
var contentContainer=document.querySelectorAll(".post-body")[0];const dataTracking=contentContainer.setAttribute("data-tracking-container","true");var headings=contentContainer.querySelectorAll("h1,h2,h3,h4,h5,h6"),showtoc=contentContainer.querySelectorAll(".post-body h1,.post-body h2,.post-body h3,.post-body h4,.post-body h5,.post-body h6");if(headings.length>3)for(i=0;i<=showtoc.length-1;i++){showtoc[i].insertAdjacentHTML("beforebegin",'<div class="toc-auto"><input id="toc-sh" type="checkbox"><label class="toc-title" for="toc-sh">Table of Contents</label><div class="toc" id="toc"></div></div>'),(tocatr=document.querySelectorAll(".toc-auto")[0]).setAttribute("data-tracking-container","true");var e,t=document.querySelectorAll(".toc-auto");[].filter.call(t,function(e){return![].some.call(e.attributes,function(e){return/^data-tracking-container/i.test(e.name)})}).forEach(function(e){e.parentNode.removeChild(e)})}class TableOfContents{constructor({from:e,to:t}){this.fromElement=e,this.toElement=t,this.headingElements=this.fromElement.querySelectorAll("h1, h2, h3, h4, h5, h6"),this.tocElement=document.createElement("div")}getMostImportantHeadingLevel(){let e=6;for(let t=0;t<this.headingElements.length;t++){let n=TableOfContents.getHeadingLevel(this.headingElements[t]);e=n<e?n:e}return e}static generateId(e){return e.textContent.toLowerCase().replace(/ /g,"_").replace(/\//g,"_").replace(/&lt;/g,"").replace(/&gt;/g,"").replace(/&amp;/g,"").replace(/&amp;nbsp;/g,"").replace(/&nbsp;/g,"").replace(/\xA0/g,"").replace(/[\n\r\f]+/g,"").replace(/[.,\#!$%\^&\*;:{}=\-@`~()<>?"'“+”]/g,"")}static getHeadingLevel(e){switch(e.tagName.toLowerCase()){case"h1":default:return 1;case"h2":return 2;case"h3":return 3;case"h4":return 4;case"h5":return 5;case"h6":return 6}}generateToc(){let e=this.getMostImportantHeadingLevel()-1,t=this.tocElement;for(let n=0;n<this.headingElements.length;n++){let o=this.headingElements[n],a=TableOfContents.getHeadingLevel(o),r=a-e,l=document.createElement("a");if(o.id||(o.id=TableOfContents.generateId(o)),l.href=`#${o.id}`,l.textContent=o.textContent,r>0){for(let c=0;c<r;c++){let s=document.createElement("ul"),h=document.createElement("li");s.appendChild(h),t.appendChild(s),t=h}t.appendChild(l)}else{for(let d=0;d<-r;d++)t=t.parentNode.parentNode;let g=document.createElement("li");g.appendChild(l),t.parentNode.appendChild(g),t=g}e=a}this.toElement.appendChild(this.tocElement.firstChild)}}document.addEventListener("DOMContentLoaded",()=>new TableOfContents({from:document.querySelector(".post-body"),to:document.querySelector(".toc")}).generateToc());

// Youtube Responsive
setTimeout(function(){$(".video-youtube").each(function(){$(this).replaceWith('<iframe class="video-youtube loader" src="'+$(this).data("src")+'" allowfullscreen="allowfullscreen" height="281" width="500"></iframe>')})},5e3);

/* related post */
function relatedPost(){let e=$("#relatedPost"),t=e.data("limit"),l=e.data("id"),a=e.data("title");if(e.length>0){let s=e.data("labels").split(",");if(s.length<1)return e.remove(),!1;e.html(' <div class="text-center py-3"><div class="spinner-grow text-primary" role="status"> <span class="visually-hidden">Loading...</span> </div></div> ');let i=[],n=[];$.each(s,function(e,t){i.push($.ajax({url:"/feeds/posts/default/-/"+t+"?alt=json-in-script&max-results=5&callback=?",method:"get",dataType:"jsonp",success:function(e){n.push(e)}}))}),$.when.apply(null,i).done(function(){var s;let i=[];$.each(n,function(e,t){$.each(t.feed.entry,function(e,t){let l=[];l.id=t.id.$t.substr(t.id.$t.indexOf("post-")+5),l.title=t.title.$t;let a=e=>{let t=new Date(e);return`${["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]} ${t.getDate()}, ${t.getFullYear()}`};l.published=a(t.published.$t),l.updated=a(t.updated.$t),$.each(t.link,function(e,t){"alternate"==t.rel&&(l.url=t.href)}),t.media$thumbnail?l.image=t.media$thumbnail.url.replace("/s72-c/","/w150-h150-p-k-no-nu/"):l.image="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj3Ia32aeortEtnG6libJiXjj6It8o5ikSjQEaPSvLK09ORfnWovo0FQX25VeAB-cSySlozaol3LZ-9C7BVpfeMMcxtEE7SxW-BCLVX4wwywof7kiBCp8nsHbre7ScleqehuZzY0G17M1mBV1H-KzYd1QW098SZzEAHE0GecLG5u2ULhnEYtKTsWUMp/w300/no-image.jpg",i.push(l)})});let r;if((i=(i=(e=>{for(var t,l,a=e.length;0!==a;)l=Math.floor(Math.random()*a),t=e[a-=1],e[a]=e[l],e[l]=t;return e})(i=(r=(s=i=i.filter(function(e){return e.id!==l})).map(e=>Object.values(e).join("")),s.filter((e,t)=>r.indexOf(r[t])===t)))).slice(0,t)).length>0){let o=`<div class="list-group rounded-0 w-auto px-3 px-md-4 py-2"> <strong class="fs-4 mb-2"> ${a} </strong>`;$.each(i,function(e,t){o+=` <a class="post-card list-group-item list-group-item-action d-flex align-items-center gap-3 p-0" href="${t.url}" title="${t.title}"> <div class="post-image"> <img alt="${t.title}" class="imgfluid lazy" data-src="${t.image}" height="150" loading="lazy" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" title="${t.title}" width="150"/> </div> <div class="d-flex flex-column py-2"> <h2 class="post-title m-auto py-2">${t.title}</h2> <small class="post-date"> ${t.published} </small> </div> </a> `}),o+="</div>",e.html(o)}else e.remove()})}}

/* post comment */
function postComment(){$("#comment-editor").length>0&&$.getScript("https://www.blogger.com/static/v1/jsbin/3262169375-comment_from_post_iframe.js",function(t,e,m){BLOG_CMT_createIframe("https://www.blogger.com/rpc_relay.html");let o=$("#comment-editor").data("src").split("#");$(".commentActionButton").on("click",function(){let t=$("#commentForm"),e=$(this).data("id"),m=$("#comment-editor"),n="addNewComment"!=e?$("#form-container-"+e):$("#commentFormWrapper");m.attr("src","addNewComment"!=e?o[0]+"&parentID="+e+"#"+o[1]:o[0]+"#"+o[1]),"addNewComment"!=e?$("#addNewcomment").removeClass("d-none"):$("#addNewcomment").addClass("d-none"),n.html(t)})})}

/* copythis */
function copyThis(o){$("body").append(`<textarea id="gocopy">${o}</textarea>`),$("#gocopy").select(),document.execCommand("copy"),$("#gocopy").remove(),showToast("Success Copy")}

/* Imgur Upload Script */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Imgur=e()}(this,function(){"use strict";var t=function(e){if(!this||!(this instanceof t))return new t(e);if(e||(e={}),!e.clientid)throw"Provide a valid Client Id here: https://api.imgur.com/";this.clientid=e.clientid,this.endpoint="https://api.imgur.com/3/image",this.callback=e.callback||void 0,this.dropzone=document.querySelectorAll(".dropzone"),this.infoimg=document.querySelectorAll(".infoimg"),this.run()};return t.prototype={createEls:function(t,e,i){var a,s=document.createElement(t);for(a in e)e.hasOwnProperty(a)&&(s[a]=e[a]);return i&&s.appendChild(document.createTextNode(i)),s},insertAfter:function(t,e){t.parentNode.insertBefore(e,t.nextSibling)},post:function(t,e,i){var a=new XMLHttpRequest;a.open("POST",t,!0),a.setRequestHeader("Authorization","Client-ID "+this.clientid),a.onreadystatechange=function(){if(4===this.readyState){if(this.status>=200&&this.status<300){var t="";try{t=JSON.parse(this.responseText)}catch(e){t=this.responseText}i.call(window,t)}else throw Error(this.status+" - "+this.statusText)}},a.send(e),a=null},createDragZone:function(){var t,e,i;t=this.createEls("p",{},"Seret file gambar ke sini"),e=this.createEls("p",{},"Atau klik untuk memilih foto"),i=this.createEls("input",{type:"file",className:"input",accept:"image/*"}),Array.prototype.forEach.call(this.infoimg,(function(i){i.appendChild(t),i.appendChild(e)}).bind(this)),Array.prototype.forEach.call(this.dropzone,(function(t){t.appendChild(i),this.status(t),this.upload(t)}).bind(this))},loading:function(){var t,e,i;t=this.createEls("div",{className:"loading-modal"}),e=this.createEls("table",{className:"loading-table"}),i=this.createEls("img",{className:"loading-image",src:"https://cdn.jsdelivr.net/gh/astectic/imgur/src/svg/loading-spin.svg"}),t.appendChild(e),e.appendChild(i),document.body.appendChild(t)},status:function(t){var e=this.createEls("div",{className:"status"});this.insertAfter(t,e)},matchFiles:function(t,e){var i=e.nextSibling;if(t.type.match(/image/)&&"image/svg+xml"!==t.type){document.body.classList.add("loading"),i.classList.remove("bg-success","bg-danger"),i.innerHTML="";var a=new FormData;a.append("image",t),this.post(this.endpoint,a,(function(t){document.body.classList.remove("loading"),"function"==typeof this.callback&&this.callback.call(this,t)}).bind(this))}else i.classList.remove("bg-success"),i.classList.add("bg-danger"),i.innerHTML="Invalid archive"},upload:function(t){var e,i,a,s;t.addEventListener("change",(function(n){if(n.target&&"INPUT"===n.target.nodeName&&"file"===n.target.type)for(a=0,s=(i=n.target.files).length;a<s;a+=1)e=i[a],this.matchFiles(e,t)}).bind(this),!1),["dragenter","dragleave","dragover","drop"].map(function(e){t.addEventListener(e,function(t){t.target&&"INPUT"===t.target.nodeName&&"file"===t.target.type&&("dragleave"===e||"drop"===e?t.target.parentNode.classList.remove("dropzone-dragging"):t.target.parentNode.classList.add("dropzone-dragging"))},!1)})},run:function(){document.querySelector(".loading-modal")||this.loading(),this.createDragZone()}},t});var feedback=function(t){if(!0===t.success){var e=t.data.link.replace(/^http:\/\//i,"https://");document.querySelector(".status").classList.add("bg-success"),document.querySelector(".status").innerHTML='<div class="linkimg"><input class="image-url" id="copylinkimg" onclick="this.select()" value="'+e+'"/></div><div class="showimg"><img class="img" alt="Imgur-Upload" src="'+e+'"/></div>'}};new Imgur({clientid:"e5a2167b11581f6",callback:feedback});

// Threaded Blogger Gambar Video
const img=/\b(http(?:s)?:\/\/\S+(?:png|jpe?g|gif|bmp|svg|tif)\S*)\b/gi,ytb=/(http:|https:)?\/\/(www\.)?(youtube.com|youtu.be)\/(watch)?(\?v=)?(\S+)?/gi;for(var cmts=document.getElementsByClassName("commentBody"),i=0;i<cmts.length;i++){var e=cmts[i].innerHTML;if(img.test(e))for(var t=e.match(img),a=0;a<t.length;a++)e=e.replace(t[a],"<img alt='image' class='lazy' data-src='"+t[a]+"' src='data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=' loading='lazy'/>");if(ytb.test(e))for(var s=e.match(ytb),c=0;c<s.length;c++)e=e.replace(s[c],"<div class='embed'><iframe class='lazy' loading='lazy' data-src='https://www.youtube.com/embed/"+s[c].split("=")[1]+"' title='YouTube Comment' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' allowfullscreen=''></iframe></div>");cmts[i].innerHTML=e}
